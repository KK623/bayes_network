# 贝叶斯网与概率推理

[TOC]



## 4.1 推理问题

贝叶斯网的推理问题有三类

1. 后验概率问题
2. 最大后验假设问题
3. 最大可能解释问题

### 后验概率问题没啥用

> 后验概率问题指的是==已知贝叶斯网络中某些变量的取值==，计算另外一些变量的后验概率分布。

- 已知变量称为**证据变量**，称为**E**，取值记为$\mathbf{e}$
- 需要计算其后验概率分布的变量称为**查询变量**，称为**Q**，需要计算的后验分布为$P(\mathbf{Q}|\mathbf{E}=e)$

概率推理就是后验概率问题，有四类

1. 从结果到原因的诊断推理
2. 从原因到结果的预测推理
3. 在同一结果的不同原因之间的原因关系推理
4. 包含上述类型的混合推理



### 最大后验假设问题

> $\mathbf{h}^{*}=\mathop{\arg}\max\limits_{\theta}P(H=h|E=e)$ ，MAP问题

### 最大可能解释问题

> 没啥用

## 4.2 变量消元方法

说明联合分布的分解可以降低概率推理复杂度

### 概率分布的分解与推理复杂度

### 消元运算

### 算法描述(VE)

输入：

1. $\mathcal{N}$ 一个贝叶斯网
2. $\mathbf{E}$,证据变量
3. $\mathbf{e}$,证据变量的取值
4. $\mathbf{Q}$,查询变量
5. $\rho$,消元顺序

输出：$P(\mathbf{Q|E=e})$

1. $\mathscr{F}$ <- $\mathcal{N}$ 中所有概率分布的集合
2. 在$\mathscr{F}$中，讲证据变量$\mathbf{E}$设置为其观测值$\mathbf{e}$
3. while($\rho \neq 0$)
   1. 设Z是$\rho$中最前面的变量，将 Z从$\rho$中删除
   2. $\mathscr{F}$ <- Elim($\mathscr{F}$,Z)
4. end while
5. 将$\mathscr{F}$中所有因子相乘，得到一个Q的函数h(Q)
6. return $\frac{h(Q)}{\sum_Qh(Q)}$



### 算法描述(Elim)

输入：

1. $\mathscr{F}$ ,一个函数集合
2. Z,待消元集合

输出：另一个函数集合

1. 从$\mathscr{F}$中删除所有设计Z的函数，设这些函数是${f_1,f_2,\cdots,f_k}$
2. $g<- \prod_{i=1}^{k}f_i$
3. $h<- \sum_Zg$
4. 将h放回$\mathscr{F}$
5. 返回$\mathscr{F}$

## 4.3 复杂度分析

## 4.4 消元顺序

### 最大势搜索

### 最小缺边算法



